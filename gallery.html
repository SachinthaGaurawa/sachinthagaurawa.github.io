<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Album — Sachintha Gaurawa</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- Favicon -->
  <link rel="icon" href="img/sg_logo.ico" type="image/x-icon">
  <link rel="shortcut icon" href="img/sg_logo.ico" type="image/x-icon">
  <link rel="icon" type="image/png" sizes="32x32" href="img/sg_logo.png">
  <link rel="icon" type="image/png" sizes="64x64" href="img/sg_logo.png">

  <!-- Live Preview -->
  <link rel="stylesheet" href="css/site.css?v=2025-08-15-1">
  <script src="js/app.js?v=2025-08-15-1"></script>

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Inter:wght@300;400;600;800&display=swap" rel="stylesheet">

  <!-- Icons + Styles -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" rel="stylesheet">
  <link rel="stylesheet" href="style.css">

  <!-- GSAP -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/ScrollTrigger.min.js" defer></script>

  <!-- AOS (Animate On Scroll) -->
  <link rel="stylesheet" href="https://unpkg.com/aos@2.3.4/dist/aos.css">
  <script src="https://unpkg.com/aos@2.3.4/dist/aos.js" defer></script>
  <script>
    window.addEventListener('load', () => {
      if (window.AOS) {
        AOS.init({ duration: 700, once: true, easing: 'ease-out-cubic', offset: 60 });
      }
    });
  </script>

  <!-- (Optional) On-device AI utilities -->
  <script src="https://cdn.jsdelivr.net/npm/@xenova/transformers/dist/transformers.min.js" defer></script>

  <!-- Initial body classes (kept) -->
  <script>
    document.addEventListener('DOMContentLoaded', function () {
      document.body.classList.add('home','is-dark');
    });
  </script>

  <!-- Live Preview cache-bust (kept) -->
  <script>
  (function(){
    if (!localStorage.getItem('devBust')) return;
    const stamp = Date.now();
    document.querySelectorAll('link[rel="stylesheet"][data-bust], script[src][data-bust]').forEach(el => {
      const attr = el.tagName === 'LINK' ? 'href' : 'src';
      const url  = new URL(el.getAttribute(attr), location.href);
      url.searchParams.set('v', stamp);
      el.setAttribute(attr, url.toString());
    });
    console.log('[cache-bust] active', stamp);
  })();
  </script>

  <!-- === THEME LAYER + TOGGLE STYLES (scoped, safe overrides) === -->
  <style>
    /* Light defaults */
    :root {
      --bg0: #f5f7fb; --bg1: #ffffff; --surface: rgba(255,255,255,.86);
      --ink: #0e0f11; --muted-ink: #6e7481; --border: #e9eef5;
      --chip-bg: #ffffff; --chip-ink: #111827;
      --shadow-1: 0 10px 30px rgba(30,40,60,.08);
      --shadow-2: 0 16px 50px rgba(20,50,90,.12);
      --ring: rgba(4,112,255,.25);
    }
    /* Dark tokens */
    html[data-theme="dark"] {
      --bg0: #0d1218; --bg1: #0f1621; --surface: rgba(14,18,26,0.86);
      --ink: #e9f2f9; --muted-ink: #9aa3b2; --border: #1b2532;
      --chip-bg: #0b1218; --chip-ink: #dbe6ef;
      --shadow-1: 0 10px 30px rgba(0,0,0,.40);
      --shadow-2: 0 18px 55px rgba(0,0,0,.55);
    }
    /* Respect OS dark on first paint if no explicit choice yet */
    @media (prefers-color-scheme: dark) {
      html:not([data-theme]) {
        --bg0:#0d1218; --bg1:#0f1621; --surface:rgba(14,18,26,.86);
        --ink:#e9f2f9; --muted-ink:#9aa3b2; --border:#1b2532;
        --chip-bg:#0b1218; --chip-ink:#dbe6ef;
        --shadow-1:0 10px 30px rgba(0,0,0,.40);
        --shadow-2:0 18px 55px rgba(0,0,0,.55);
      }
    }
    /* Smooth theming */
    html, body, .topbar, .controls .search, .card, .site-footer,
    #albumView, .album-desc-block, .m-item, .album-ask .ask-row {
      transition: background-color .25s ease, color .25s ease, border-color .25s ease, box-shadow .25s ease;
    }
    /* Apply tokens to your existing blocks */
    body { background: var(--bg0); color: var(--ink); }
    .topbar { background: var(--surface); border-bottom:1px solid var(--border); }
    .controls .search { background: var(--bg1); border:1px solid var(--border); box-shadow: var(--shadow-1); }
    .controls .search input { color: var(--ink); }
    .controls .search i { color: var(--muted-ink); }
    .chip { background: var(--chip-bg); color: var(--chip-ink); border:1px solid var(--border); }
    .card { background: var(--bg1); border:1px solid var(--border); box-shadow: var(--shadow-1); }
    .card:hover { box-shadow: var(--shadow-2); }
    #albumView { background: var(--bg0); }
    .album-desc-block { background: var(--bg0); color: var(--ink); }
    .album-desc-inner { color: color-mix(in oklab, var(--ink) 88%, #888); }
    .m-item { border:1px solid color-mix(in oklab, var(--border) 85%, transparent); box-shadow: 0 8px 24px rgba(0,0,0,.28); }
    .album-ask .ask-row { background: color-mix(in oklab, var(--bg1) 92%, #000); border:1px solid var(--border); }
    .album-ask input { color: var(--ink); }

    /* Footer centering on phones/tablets portrait (kept from your spec) */
    @media (max-width:1024px) and (orientation:portrait){
      .site-footer{ display:flex !important; flex-direction:column !important;
        align-items:center !important; justify-content:center !important;
        text-align:center !important; gap:10px !important; }
      .site-footer .footer-left,.site-footer .footer-right{
        width:100% !important; margin:0 !important; display:inline-flex !important;
        align-items:center !important; justify-content:center !important; text-align:center !important;
      }
      .site-footer .footer-right{ margin-left:0 !important; }
    }

    /* Toggle row (below topbar) */
    .theme-row { width:min(1200px,95vw); margin:10px auto 0; }
    .theme-toggle{
      --pill-bg: color-mix(in oklab, var(--bg1) 88%, #fff);
      --pill-border: color-mix(in oklab, var(--border) 80%, transparent);
      display:inline-flex; align-items:center; gap:.6rem;
      padding:10px 14px; border-radius:999px;
      background: var(--pill-bg);
      border: 1px solid var(--pill-border);
      box-shadow: inset 0 0 0 1px rgba(255,255,255,.04), 0 6px 16px rgba(0,0,0,.10);
      color: var(--ink); font-weight:600;
    }
    .theme-toggle__thumb{ width:22px; height:22px; display:grid; place-items:center; }
    .theme-toggle:focus-visible{ outline:2px solid #f1b32a; outline-offset:2px; }
    @media (max-width:768px){ .theme-row{ margin:8px auto 0; } }
    /* Subtle vignette in dark */
    html[data-theme="dark"] body {
      background: radial-gradient(1200px 400px at 50% -200px, rgba(255,255,255,.06), transparent 60%), var(--bg0);
    }
  </style>
</head>

<body>
  <!-- Top bar -->
  <header class="topbar">
    <a class="brand" href="https://sachinthagaurawa.github.io/" target="_blank" rel="noopener">Sachintha Gaurawa</a>
    <h1 class="center-title">Album</h1>
    <div class="spacer"></div>
  </header>

  <body class="home is-dark">


    <!-- Theme toggle row (mobile & desktop) -->
  <section class="theme-row" aria-label="Theme">
    <button id="themeToggle" class="theme-toggle" type="button" aria-label="Toggle color theme" aria-pressed="false">
      <span class="theme-toggle__thumb" aria-hidden="true">🌗</span>
      <span class="theme-toggle__label">Dark</span>
    </button>
  </section>



  <!-- Outside hero -->
  <section class="hero" data-aos="fade-up">
    <div class="hero-media" data-aos="zoom-in" data-aos-delay="80">
      <img
        class="lazy-cover"
        src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==" 
        data-src="https://images.unsplash.com/photo-1542273917363-3b1817f69a2d?q=80&w=1600&auto=format&fit=crop"
        alt="Foggy forest"
      >
      <noscript>
        <img
          src="https://images.unsplash.com/photo-1542273917363-3b1817f69a2d?q=80&w=1600&auto=format&fit=crop"
          alt="Foggy forest">
      </noscript>
      <div class="hero-overlay"></div>
      <div class="hero-text">
        <h2>Projects & Albums</h2>
        <p>Electronics • Robotics • AI Safety — curated visuals, experiments, and demo reels.</p>
      </div>
    </div>
  </section>

  <!-- Search -->
  <section class="controls container" data-aos="fade-up" data-aos-delay="120">
    <div class="search">
      <div class="tag-chips" id="chips"></div>
      <i class="fa-solid fa-magnifying-glass" aria-hidden="true"></i>
      <input id="searchInput" type="text" placeholder="Search by title or tags… (e.g., AAVSS, dataset, lidar)" aria-label="Search albums">
    </div>
  </section>

  <!-- Album grid -->
  <section class="container" id="albumGrid" aria-label="Album Grid" data-aos="fade-up" data-aos-delay="160"></section>

  <!-- INSIDE ALBUM -->
  <div id="albumView" aria-hidden="true">
    <button class="close-btn" id="closeAlbum" aria-label="Close album (Esc)">
      <i class="fa-solid fa-xmark"></i>
    </button>

    <!-- Banner -->
    <a id="albumHeroLink" class="album-hero slim" href="#" target="_blank" rel="noopener" data-aos="fade-up" data-aos-delay="40">
      <img id="albumHeroImg" src="" alt="">
      <div class="album-hero-overlay"></div>
      <h2 id="albumHeroTitle"></h2>
    </a>

    <!-- Description -->
    <section class="album-desc-block" data-aos="fade-up" data-aos-delay="120">
      <div class="album-desc-inner">
        <p id="albumDesc"></p>
      </div>
    </section>

    <!-- 🔥 Ask this album (AI) -->
    <section class="album-ask container" data-aos="fade-up" data-aos-delay="140">
      <div class="ask-row">
        <input id="askInput" type="text"
               placeholder="Ask about this project… (e.g., sensors used, pipeline, FPS)" aria-label="Ask about this album">
        <button id="askBtn" class="ask-btn" type="button">Ask</button>
      </div>
      <div id="askResult" class="ask-result" aria-live="polite"></div>
    </section>

    <!-- Masonry -->
    <section class="album-media container" data-aos="fade-up" data-aos-delay="160">
      <div id="albumMasonry" class="masonry" aria-label="Album media masonry grid"></div>
    </section>
  </div>

  <!-- CLICK LIGHTBOX (opens only on click) -->
  <div id="viewerOverlay" aria-hidden="true">
    <div class="viewer-shell">
      <button class="viewer-close" id="viewerClose" aria-label="Close viewer (Esc)"><i class="fa-solid fa-xmark"></i></button>
      <button class="nav prev" id="prevBtn" aria-label="Previous (←)"><i class="fa-solid fa-chevron-left"></i></button>
      <figure class="stage" id="stage" aria-live="polite"></figure>
      <button class="nav next" id="nextBtn" aria-label="Next (→)"><i class="fa-solid fa-chevron-right"></i></button>
      <img id="peekPrev" class="peek peek-left" alt="">
      <img id="peekNext" class="peek peek-right" alt="">
      <div class="hint">Space: Play/Pause • ←/→: Prev/Next • Tap: Play/Pause • Swipe: Navigate</div>
    </div>
  </div>

  <!-- Footer -->
  <footer id="siteFooter" class="site-footer" data-aos="fade-up" data-aos-offset="0">
    <div class="footer-left">
      © <span id="year"></span> <span class="footer-name">Sachintha Gaurawa</span>, All Rights Reserved.
    </div>
    <div class="footer-right">
      Engineered with Innovation
    </div>
  </footer>

  <script>
    // Footer year
    document.getElementById("year").textContent = new Date().getFullYear();
  </script>

  <!-- Load your app logic ONCE (single include only). Keep this at the end. -->
  <script src="app.js?v=8" defer></script>
</body>
</html>
